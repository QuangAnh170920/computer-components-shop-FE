<form [formGroup]="form!">
    <div class="card">
        <div class="grid">
            <div class="col-6">
                <input
                    type="text"
                    formControlName="name"
                    pInputText
                    [placeholder]="placeHolder"
                    class="p-inputtext p-component p-element w-full"
                />
            </div>
            <div class="col-6">
                <div class="flex justify-content-end gap-3">
                    <p-button
                        label="Tìm kiếm"
                        icon="pi pi-search"
                        (onClick)="onSearch()"
                    ></p-button>
                    <p-button
                        (click)="showDialog()"
                        icon="pi pi-external-link"
                        label="Thêm mới"
                    ></p-button>
                </div>
            </div>
        </div>
    </div>

    <div class="card mt-3">
        <p-table
            #dt
            [value]="data"
            [lazy]="true"
            (onLazyLoad)="lazyLoad($event)"
            [showCurrentPageReport]="true"
            dataKey="id"
            [rows]="rows"
            [rowsPerPageOptions]="[10, 25, 50]"
            [paginator]="true"
            [totalRecords]="totalRecords"
            styleClass="datatable-responsive p-datatable-gridlines"
            currentPageReportTemplate="Hiển thị từ  {first} đến {last} trên tổng số  {totalRecords} bản ghi"
            [tableStyle]="{ 'min-width': '50rem' }"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th class="text-center">STT</th>
                    <th class="text-center">Mã mẫu báo giá</th>
                    <th class="text-center">Tên mẫu báo giá</th>
                    <th class="text-center">Mô tả</th>
                    <th style="width: 15%" class="text-center">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-quote let-i="rowIndex">
                <tr>
                    <td class="text-center">{{ i + 1 }}</td>
                    <td class="text-center">
                        {{ quote?.quoteTemplateCode }}
                    </td>
                    <td>{{ quote?.quoteTemplateName }}</td>
                    <td [innerHTML]="quote?.describe">{{ quote?.describe }}</td>
                    <td class="text-center">
                        <p-button
                            styleClass="p-element p-ripple p-button-rounded p-button-text p-button p-component p-button-icon-only p-button-info mr-2"
                            icon="pi pi-eye"
                        ></p-button>
                        <p-button
                            styleClass="p-element p-ripple p-button-rounded p-button-text p-button p-component p-button-icon-only p-button-info mr-2"
                            icon="pi pi-file-edit"
                        ></p-button>
                        <p-button
                            styleClass="p-element p-ripple p-button-rounded p-button-text p-button p-component p-button-icon-only p-button-info mr-2"
                            icon="pi pi-trash"
                        ></p-button>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</form>

<p-dialog header="Thêm mới" [(visible)]="visible" [style]="{ width: '50vw' }">
    <form [formGroup]="form!">
        <div class="p-fluid">
            <div class="p-formgrid grid">
                <div class="field col-12 lg:col-6">
                    <label htmlfor="title"
                        >Tên mẫu báo giá<span class="p-error">*</span></label
                    >
                    <input
                        pInputText
                        id="title"
                        type="text"
                        class="p-inputtext p-component p-element"
                        formControlName="quoteTemplateName"
                        [ngClass]="
                            f['quoteTemplateName'].errors &&
                            (f['quoteTemplateName'].dirty ||
                                f['quoteTemplateName'].touched)
                                ? 'ng-dirty ng-invalid'
                                : ''
                        "
                    />
                    <span
                        class="p-error font-italic"
                        *ngIf="
                            f['quoteTemplateName'].errors &&
                            (f['quoteTemplateName'].dirty ||
                                f['quoteTemplateName'].touched)
                        "
                    >
                        <small
                            *ngIf="
                                f['quoteTemplateName'].errors['required'] ||
                                f['quoteTemplateName'].errors['whitespace']
                            "
                            >Tên mẫu báo giá không được để trống</small
                        >
                        <span
                            *ngIf="
                                f['quoteTemplateName'].errors &&
                                f['quoteTemplateName'].errors['maxlength']
                            "
                            class="p-error font-italic"
                        >
                            <small
                                >Tên mẫu báo giá không được vượt quá 255 ký
                                tự</small
                            >
                        </span>
                    </span>
                </div>
                <div class="field col-12 lg:col-6">
                    <label htmlfor="display_order"
                        >Mã mẫu báo giá<span class="p-error">*</span></label
                    >
                    <input
                        pInputText
                        id="title"
                        type="text"
                        class="p-inputtext p-component p-element"
                        formControlName="quoteTemplateCode"
                        [ngClass]="
                            f['quoteTemplateCode'].errors &&
                            (f['quoteTemplateCode'].dirty ||
                                f['quoteTemplateCode'].touched)
                                ? 'ng-dirty ng-invalid'
                                : ''
                        "
                    />
                    <span
                        class="p-error font-italic"
                        *ngIf="
                            f['quoteTemplateCode'].errors &&
                            (f['quoteTemplateCode'].dirty ||
                                f['quoteTemplateCode'].touched)
                        "
                    >
                        <small
                            *ngIf="
                                f['quoteTemplateCode'].errors['required'] ||
                                f['quoteTemplateCode'].errors['whitespace']
                            "
                            >Mã mẫu báo giá không được để trống</small
                        >
                        <span
                            *ngIf="
                                f['quoteTemplateCode'].errors &&
                                f['quoteTemplateCode'].errors['maxlength']
                            "
                            class="p-error font-italic"
                        >
                            <small
                                >Mã mẫu báo giá không được vượt quá 255 ký
                                tự</small
                            >
                        </span>
                    </span>
                </div>
                <div class="field col-12 lg:col-12">
                    <label htmlfor="note"
                        >Nội dung email<span class="p-error">*</span></label
                    >
                    <p-editor
                        formControlName="contentEmail"
                        [style]="{ height: '150px' }"
                        [ngClass]="
                            f['contentEmail'].errors &&
                            (f['contentEmail'].dirty ||
                                f['contentEmail'].touched)
                                ? 'ng-dirty ng-invalid'
                                : ''
                        "
                    >
                        <ng-template pTemplate="header">
                            <div class="p-editor-toolbar">
                                <span class="ql-formats">
                                    <select class="ql-header">
                                        <option value="1">Heading</option>
                                        <option value="2">Subheading</option>
                                        <option selected="">Normal</option>
                                    </select>
                                    <span class="ql-font ql-picker">
                                        <select class="ql-font">
                                            <option selected="">
                                                Sans Serif
                                            </option>
                                            <option value="serif">Serif</option>
                                            <option value="monospace">
                                                Monospace
                                            </option>
                                            <option value="roboto">
                                                Roboto
                                            </option>
                                            <option value="times-new-roman">
                                                Time New Roman
                                            </option>
                                        </select>
                                    </span>
                                    <span>
                                        <select
                                            title="Font Size"
                                            class="ql-size"
                                        >
                                            <option value="small">small</option>
                                            <option value="normal">
                                                normal
                                            </option>
                                            <option value="large">large</option>
                                            <option value="huge">huge</option>
                                        </select>
                                    </span>
                                    <span>
                                        <select class="ql-align">
                                            <option selected=""></option>
                                            <option value="center">
                                                center
                                            </option>
                                            <option value="right">right</option>
                                            <option value="justify">
                                                justify
                                            </option>
                                        </select></span
                                    >
                                    <button
                                        class="ql-script"
                                        value="sub"
                                    ></button>
                                    <button
                                        class="ql-script"
                                        value="super"
                                    ></button>
                                    <button class="ql-clean"></button>
                                    <button
                                        type="button"
                                        class="ql-font"
                                        aria-label="Bold"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-bold"
                                        aria-label="Bold"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-italic"
                                        aria-label="Italic"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-underline"
                                        aria-label="Underline"
                                    ></button>
                                    <button
                                        aria-label="Insert Link"
                                        type="button"
                                        class="ql-link"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-image"
                                        aria-label="Image"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-video"
                                        aria-label="Video"
                                    ></button>
                                </span>
                            </div>
                        </ng-template>
                    </p-editor>
                    <span
                        class="p-error font-italic"
                        *ngIf="
                            f['contentEmail'].errors &&
                            (f['contentEmail'].dirty ||
                                f['contentEmail'].touched)
                        "
                    >
                        <small
                            *ngIf="
                                f['contentEmail'].errors['required'] ||
                                f['contentEmail'].errors['whitespace']
                            "
                            >Nội dung email không được để trống</small
                        >
                        <span
                            *ngIf="
                                f['contentEmail'].errors &&
                                f['contentEmail'].errors['maxlength']
                            "
                            class="p-error font-italic"
                        >
                            <small
                                >Nội dung email không được vượt quá 255 ký
                                tự</small
                            >
                        </span>
                    </span>
                </div>
                <div class="field col-12 lg:col-12">
                    <label htmlfor="note"
                        >Mô tả<span class="p-error">*</span></label
                    >
                    <p-editor
                        formControlName="describe"
                        [style]="{ height: '150px' }"
                        [ngClass]="
                            f['describe'].errors &&
                            (f['describe'].dirty ||
                                f['describe'].touched)
                                ? 'ng-dirty ng-invalid'
                                : ''
                        "
                    >
                        <ng-template pTemplate="header">
                            <div class="p-editor-toolbar">
                                <span class="ql-formats">
                                    <select class="ql-header">
                                        <option value="1">Heading</option>
                                        <option value="2">Subheading</option>
                                        <option selected="">Normal</option>
                                    </select>
                                    <span class="ql-font ql-picker">
                                        <select class="ql-font">
                                            <option selected="">
                                                Sans Serif
                                            </option>
                                            <option value="serif">Serif</option>
                                            <option value="monospace">
                                                Monospace
                                            </option>
                                            <option value="roboto">
                                                Roboto
                                            </option>
                                            <option value="times-new-roman">
                                                Time New Roman
                                            </option>
                                        </select>
                                    </span>
                                    <span>
                                        <select
                                            title="Font Size"
                                            class="ql-size"
                                        >
                                            <option value="small">small</option>
                                            <option value="normal">
                                                normal
                                            </option>
                                            <option value="large">large</option>
                                            <option value="huge">huge</option>
                                        </select>
                                    </span>
                                    <span>
                                        <select class="ql-align">
                                            <option selected=""></option>
                                            <option value="center">
                                                center
                                            </option>
                                            <option value="right">right</option>
                                            <option value="justify">
                                                justify
                                            </option>
                                        </select></span
                                    >
                                    <button
                                        class="ql-script"
                                        value="sub"
                                    ></button>
                                    <button
                                        class="ql-script"
                                        value="super"
                                    ></button>
                                    <button class="ql-clean"></button>
                                    <button
                                        type="button"
                                        class="ql-font"
                                        aria-label="Bold"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-bold"
                                        aria-label="Bold"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-italic"
                                        aria-label="Italic"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-underline"
                                        aria-label="Underline"
                                    ></button>
                                    <button
                                        aria-label="Insert Link"
                                        type="button"
                                        class="ql-link"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-image"
                                        aria-label="Image"
                                    ></button>
                                    <button
                                        type="button"
                                        class="ql-video"
                                        aria-label="Video"
                                    ></button>
                                </span>
                            </div>
                        </ng-template>
                    </p-editor>
                    <span
                        class="p-error font-italic"
                        *ngIf="
                            f['describe'].errors &&
                            (f['describe'].dirty ||
                                f['describe'].touched)
                        "
                    >
                        <small
                            *ngIf="
                                f['describe'].errors['required'] ||
                                f['describe'].errors['whitespace']
                            "
                            >Mô tả không được để trống</small
                        >
                        <span
                            *ngIf="
                                f['describe'].errors &&
                                f['describe'].errors['maxlength']
                            "
                            class="p-error font-italic"
                        >
                            <small
                                >Mô tả không được vượt quá 255 ký
                                tự</small
                            >
                        </span>
                    </span>
                </div>
            </div>
            <div
                class="flex justify-content-end gap-3"
                style="margin-top: 10px"
            >
                <p-button label="Gửi báo giá" (click)="save()" [disabled]="form!.invalid"></p-button>
            </div>
        </div>
    </form>
</p-dialog>
